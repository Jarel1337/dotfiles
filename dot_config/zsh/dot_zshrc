# There's currently no good way to distribute this with chezmoi so just check if non-exists & clone for now
ZMOD_DIR="$XDG_DATA_HOME/zsh"
[[ ! -d "$ZMOD_DIR"/fsh ]] && git clone --depth=1 https://github.com/zdharma/fast-syntax-highlighting "$ZMOD_DIR"/fsh
[[ ! -d "$ZMOD_DIR"/powerlevel10k ]] && git clone --depth=1 https://github.com/romkatv/powerlevel10k "$ZMOD_DIR"/powerlevel10k
unset ZMOD_DIR

# Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.config/zsh/.zshrc.
# Initialization code that may require console input (password prompts, [y/n]
# confirmations, etc.) must go above this block; everything else may go below.
if [[ -r "$XDG_CACHE_HOME/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "$XDG_CACHE_HOME/p10k-instant-prompt-${(%):-%n}.zsh"
fi

setopt auto_cd
setopt hist_ignore_all_dups
setopt interactive_comments
setopt share_history

# Enable emacs mode (ctrl-A/E (jump to beginning/end of line) + ctrl-R (backwards search))
bindkey -e
# Enable ctrl left right arrow to jump between words
bindkey "^[[1;5C" forward-word
bindkey "^[[1;5D" backward-word

HISTFILE="$XDG_CACHE_HOME/zsh/history"
HISTSIZE=10000
SAVEHIST=10000

[[ ! -f "$XDG_CACHE_HOME/zsh/compdump" ]] && touch "$XDG_CACHE_HOME/zsh/compdump"
autoload -Uz compinit
zstyle ':completion:*' menu select rehash true
zmodload zsh/complist
compinit -d "$XDG_CACHE_HOME/zsh/compdump"

source "$XDG_CONFIG_HOME/shell/aliasrc"

source "$XDG_DATA_HOME/zsh/powerlevel10k/powerlevel10k.zsh-theme"
source "$XDG_DATA_HOME/zsh/fsh/fast-syntax-highlighting.plugin.zsh"

# To customize prompt, run `p10k configure` or edit $ZDOTDIR/.p10k.zsh.
[[ -r "$ZDOTDIR/.p10k.zsh" ]] && source "$ZDOTDIR/.p10k.zsh"
